<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Managing Data with Core Data: Setting Up | CodeKeep</title>
    <meta name="description" content="A Vitepress Site For Documentation">
    <meta name="generator" content="VitePress v1.4.2">
    <link rel="preload stylesheet" href="/assets/style.B_SSGfTn.css" as="style">
    
    <script type="module" src="/assets/app.BwRE_Wjg.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.COUl-GZH.js">
    <link rel="modulepreload" href="/assets/chunks/framework.ohJJpums.js">
    <link rel="modulepreload" href="/assets/articles_ios_core-data_coredata-setting-up.md.DIS1DKyL.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/okeep.png" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>CodeKeep</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/welcome-page.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Documentation</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/contact.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Contact</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible collapsed" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Concepts</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><section class="VPSidebarItem level-1" data-v-b7550ba0 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h3 class="text" data-v-b7550ba0>Design Patterns</h3><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/concepts/design-patterns/creational-patterns.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Creational Patterns</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/concepts/design-patterns/structural-patterns.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Structural Patterns</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/concepts/design-patterns/behavioral-patterns.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Behavioral Patterns</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/concepts/software-architectures.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Software Architectures</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/concepts/solid-principles.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>SOLID Principles</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible collapsed" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Tools</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/tools/cd.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>CD (Continuous Deployment)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/tools/ci.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>CI (Continuous Implementation)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible collapsed" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>iOS</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/structs-vs-classes.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Structs vs Classes in Swift</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/bindable-vs-binding-swiftui.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>@Bindable vs. @Binding in SwiftUI: What’s the difference?</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/extension-vs-protocol.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Understanding Extensions and Protocols in Swift</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1" data-v-b7550ba0 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h3 class="text" data-v-b7550ba0>Core Data</h3><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/core-data/coredata-vs-swiftdata.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Managing Data in iOS: Core Data vs SwiftData</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/core-data/coredata-fundamentals.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Managing Data with Core Data: Fundamentals</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/core-data/coredata-setting-up.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Managing Data with Core Data: Setting Up</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/core-data/coredata-crud-operations.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Managing Data with Core Data: CRUD Operations</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/ios/memory-management.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Understanding Memory Mangement in Swift</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible collapsed" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Web</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/articles/web/types-vs-interfaces.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Types vs. Interfaces in Typescript</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _articles_ios_core-data_coredata-setting-up" data-v-39a288b8><div><h1 id="managing-data-with-core-data-setting-up" tabindex="-1">Managing Data with Core Data: Setting Up <a class="header-anchor" href="#managing-data-with-core-data-setting-up" aria-label="Permalink to &quot;Managing Data with Core Data: Setting Up&quot;">​</a></h1><p><em>Last Updated: Dec 15, 2024</em></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Resources:</p><ul><li>Apple&#39;s Core Data project</li><li>HWS from Paul Hudson: <a href="https://www.hackingwithswift.com/books/ios-swiftui/how-to-combine-core-data-and-swiftui" target="_blank" rel="noreferrer">https://www.hackingwithswift.com/books/ios-swiftui/how-to-combine-core-data-and-swiftui</a></li></ul></div><p>We have seen what Core Data is, why choosing it, and its fundamentals—now it&#39;s time to get it up and running in your app!</p><p>In this article, we are going to cover different parts:</p><ul><li>Adding Core Data to your project.</li><li>Setting up the Core Data stack.</li></ul><h2 id="adding-core-data-to-your-project" tabindex="-1">Adding Core Data to Your Project <a class="header-anchor" href="#adding-core-data-to-your-project" aria-label="Permalink to &quot;Adding Core Data to Your Project&quot;">​</a></h2><p>Please open Xcode and select <code>Create New Project…</code>. Then, choose <code>App</code> in the <code>iOS</code> category.</p><div style="display:flex;justify-content:center;"><img src="/ios/coredata/cd-project.png" alt="Screenshot representing the Xcode project init"></div><p>As you can see here, we&#39;re skipping the <code>Storage</code> type, because I want to show you how to set up Core Data manually. This helps you understand the Core Data stack better and gives you more control. So please, choose your Product Name and a Team, leave <code>SwiftUI</code> and <code>Swift</code>, and choose <code>None</code> for Testing System and Storage.</p><p>Great! Now you can see in your project different files:</p><ul><li><code>CoreDataExampleApp</code> serves as the entry point of the app, defining the main application structure and launching the initial SwiftUI view.</li><li><code>ContentView</code> which is the primary view when creating an iOS application using SwiftUI.</li></ul><p>Now, let’s create our first Core Data file.</p><p>Create a new file and scroll down to find <code>Data Model</code> in the <code>Core Data</code> category:</p><div style="display:flex;justify-content:center;"><img src="/ios/coredata/cd-file.png" alt="Screenshot representing the creation of the core data model file"></div><p>Then, you can name your Data Model. I named mine <code>CoreDataExample</code>, like the app. It is <strong>not mandatory</strong> for the Data Model name to match the project name, but it is a common convention and can help avoid confusion. After naming it, it will create your <code>.xcdatamodeld</code> file. And voilà!</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>When creating your <code>.xcdatamodeld</code> file, <strong>choose the name carefully</strong> and avoid spaces or special characters.</p><ul><li>The name of this file <strong>must match</strong> the name you provide when initializing the <code>NSPersistentContainer</code>.</li><li>A mismatch between the file name and the container name will cause your app to <strong>crash at runtime</strong>.</li></ul></div><h2 id="setting-up-the-core-data-stack" tabindex="-1">Setting up the Core Data stack <a class="header-anchor" href="#setting-up-the-core-data-stack" aria-label="Permalink to &quot;Setting up the Core Data stack&quot;">​</a></h2><h3 id="the-core-data-editor" tabindex="-1">The Core Data Editor <a class="header-anchor" href="#the-core-data-editor" aria-label="Permalink to &quot;The Core Data Editor&quot;">​</a></h3><p>When created, you end up in the Core Data Editor:</p><div style="display:flex;justify-content:center;"><img src="/ios/coredata/cd-editor.png" alt="Screenshot representing the Core Data Editor"></div><p>Here’s what you’re looking at:</p><ul><li><strong>Entities</strong>: These are your data models. For example, a ‘Todo’ entity might have attributes like ‘title’ and ‘isDone’.</li><li><strong>Attributes</strong>: Define the properties of your entities, like Strings, Booleans, or Dates.</li><li><strong>Relationships</strong>: Connect entities to represent relationships, like &#39;Categories&#39; containing multiple &#39;Todos&#39;</li></ul><h3 id="entities-and-attributes" tabindex="-1">Entities and Attributes <a class="header-anchor" href="#entities-and-attributes" aria-label="Permalink to &quot;Entities and Attributes&quot;">​</a></h3><p>Great! Now let’s add our first Entity. Click on the <code>Add Entity</code> button (at the bottom of the Editor) and name it <code>Todo</code>. You can now click on Todo, and start to add attributes:</p><div style="display:flex;justify-content:center;"><img src="/ios/coredata/cd-attributes.png" alt="Screenshot representing Data Model with Entities and Attributes"></div><p>Here, we gave it 3 different attributes:</p><ul><li>An <code>id</code> of type <code>UUID</code> which is going to be the id of each todo created. It is used for unique IDs to ensure no two <code>Todo</code> objects have the same identifier.</li><li>An <code>isDone</code> attribute of type <code>Boolean</code> which is used to track completed tasks.</li><li>And a <code>title</code> attribute of type <code>String</code> which is perfect for storing text like the todo&#39;s title.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>For now, we are only going to focus on Entities and Attributes. We will see relationships on another article.</p></div><p>Be careful tho! Each attribute you create is going to be optional by default. You can choose if your attribute must be optional or not. To do so, you can click on an attribute you&#39;ve created, and open the Navigator on the left of Xcode. You see a new window appearing, with different informations.</p><p>You get the name of your attribute, its type, and different options. You can uncheck or not the <code>Optional</code> option, and that&#39;s what I did:</p><div style="display:flex;justify-content:center;"><img src="/ios/coredata/cd-navigator.png" alt="Screenshot representing the Navigator of the Core Data Editor"></div><p><strong>Why?</strong> In this project, we are always going to create a todo with these 3 attributes. However in some projects, you might need optionals, whether it’s a title or a number. So don’t forget to wrap and unwrap your optionals in your code when needed.</p><p>At this point, we’ve set up our first Core Data entity, <code>Todo</code>, with three attributes: <code>id</code> (a unique identifier), <code>isDone</code> (a Boolean to track completion), and <code>title</code> (the task name). Next, we’ll look at how these attributes behave in the Core Data stack.</p><h2 id="persistence-swift" tabindex="-1">Persistence.swift <a class="header-anchor" href="#persistence-swift" aria-label="Permalink to &quot;Persistence.swift&quot;">​</a></h2><p>When you create a new project in Xcode with <strong>Core Data</strong> enabled, Xcode automatically generates a <code>Persistence.swift</code> file for you. Its main purpose is to configure and manage the <strong>Core Data stack</strong>, ensuring your app can interact with Core Data seamlessly. However, since we didn&#39;t tell Xcode to enable it, we need to do it ourselves! No worries tho, I am here to guide you step by step on how to do it.</p><h3 id="the-core-data-stack-components" tabindex="-1">The Core Data Stack Components <a class="header-anchor" href="#the-core-data-stack-components" aria-label="Permalink to &quot;The Core Data Stack Components&quot;">​</a></h3><p>Little reminder from the previous article! The <code>Persistence.swift</code> file typically sets up the <strong>Core Data Stack</strong>:</p><ol><li><code>NSPersistentContainer</code>: Manages the Core Data stack and connects to the persistent store (e.g., SQLite database).</li><li><code>NSManagedObjectContext</code>: Provides a workspace where you create, fetch, update, and delete data.</li><li><code>Persistent Store</code>: The actual file or database where data is saved.</li></ol><h3 id="how-does-the-persistence-file-work" tabindex="-1">How Does the Persistence File Work? <a class="header-anchor" href="#how-does-the-persistence-file-work" aria-label="Permalink to &quot;How Does the Persistence File Work?&quot;">​</a></h3><p>Look at this code:</p><div class="language-swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CoreData</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PersistenceController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// A shared instance of the DataController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> shared </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PersistenceController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// The Core Data container that sets up the stack</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> container: NSPersistentContainer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Initializes the container and loads the peristent store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inMemory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        container </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NSPersistentContainer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CoreDataExample&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inMemory {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		        // Use an in-memory store, typically for testing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            container.persistentStoreDescriptions.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">first</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fileURLWithPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/dev/null&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        container.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loadPersistentStores</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">completionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { (description, error) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                fatalError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to load Core Data stack: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // Handle error, e.g., show an alert or retry mechanism</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Access the main view context</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewContext: NSManagedObjectContext {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> container.viewContext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Here’s what it does under the hood:</p><ol><li>The <code>NSPersistentContainer</code> is responsible for loading and managing the <strong>Core Data stack</strong>. It ties together the <strong>data model</strong> (<code>.xcdatamodeld</code> file), and the <strong>persistent store</strong> (e.g., SQLite, binary, or in-memory).</li><li>If <code>inMemory</code> is set to <code>true</code>, Core Data uses an <strong>in-memory store</strong> instead of saving data to disk. This is particularly useful for <strong>unit testing</strong> or SwiftUI previews because it keeps the database temporary (data will not persist between app launches), which makes testing faster.</li><li>The <code>loadPersistentStores</code> line tells the <code>NSPersistentContainer</code> to load its <strong>persistent stores</strong>. The <code>completionHandler</code> checks for errors during the loading process.</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>For production apps, consider to handle error instead of fatalError, since it&#39;s going to make your app crash.</p></div><ol start="4"><li>The <code>viewContext</code> is the <strong>main thread context</strong> of the Core Data stack. It’s made easily accessible via the <code>viewContext</code> property so that you can inject it into your SwiftUI views.</li></ol><p>To summarize: The <code>Persistence.swift</code> file sets up the Core Data stack using the <code>NSPersistentContainer</code>. It initializes the persistent store, configures an in-memory store for testing, and provides a <code>viewContext</code> for interacting with data on the main thread. This makes it easy to save, fetch, and manage your app’s data.</p><p>Now that you understand the <code>Persistence.swift</code> file and how it sets up the Core Data stack, we’re ready to start working with data! In the next article, we are going to create, fetch, update, and delete data using Core Data in a SwiftUI app.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/articles/concepts/design-patterns/creational-patterns.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Creational Patterns</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad><a href='https://github.com/carolaneLFBV' target='_blank'>GitHub</a> <a href='#' target='_blank'>LinkedIn</a></p><p class="copyright" data-v-e315a0ad>Copyright © 2020-present Carolane Lefebvre 💻</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"articles_concepts_design-patterns_behavioral-patterns.md\":\"NCIcR36V\",\"articles_concepts_design-patterns_creational-patterns.md\":\"Do9e4T1R\",\"articles_concepts_design-patterns_structural-patterns.md\":\"BENJ7APC\",\"articles_concepts_software-architectures.md\":\"CHGsD4sM\",\"articles_concepts_solid-principles.md\":\"9QW1JCae\",\"articles_ios_bindable-vs-binding-swiftui.md\":\"pM5R1YIW\",\"articles_ios_core-data_coredata-crud-operations.md\":\"BXESLuAn\",\"articles_ios_core-data_coredata-fundamentals.md\":\"BGBLBqfN\",\"articles_ios_core-data_coredata-setting-up.md\":\"DIS1DKyL\",\"articles_ios_core-data_coredata-vs-swiftdata.md\":\"CWGodjTE\",\"articles_ios_extension-vs-protocol.md\":\"QSHXM0st\",\"articles_ios_memory-management.md\":\"NWJl1nMV\",\"articles_ios_structs-vs-classes.md\":\"CftiOKKf\",\"articles_tools_cd.md\":\"CenpYCoN\",\"articles_tools_ci.md\":\"DXw-3mkL\",\"articles_web_types-vs-interfaces.md\":\"ChVea7kn\",\"contact.md\":\"CvG8l7ur\",\"index.md\":\"wMzqvX-4\",\"markdown-examples.md\":\"Ym04tqxT\",\"welcome-page.md\":\"vH7I4x8u\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"CodeKeep\",\"description\":\"A Vitepress Site For Documentation\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"},\"logo\":\"/okeep.png\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Documentation\",\"link\":\"/welcome-page\"},{\"text\":\"Contact\",\"link\":\"/contact\"}],\"sidebar\":[{\"text\":\"Concepts\",\"items\":[{\"text\":\"Design Patterns\",\"items\":[{\"text\":\"Creational Patterns\",\"link\":\"articles/concepts/design-patterns/creational-patterns.md\"},{\"text\":\"Structural Patterns\",\"link\":\"articles/concepts/design-patterns/structural-patterns.md\"},{\"text\":\"Behavioral Patterns\",\"link\":\"articles/concepts/design-patterns/behavioral-patterns.md\"}]},{\"text\":\"Software Architectures\",\"link\":\"articles/concepts/software-architectures.md\"},{\"text\":\"SOLID Principles\",\"link\":\"articles/concepts/solid-principles.md\"}],\"collapsed\":true},{\"text\":\"Tools\",\"items\":[{\"text\":\"CD (Continuous Deployment)\",\"link\":\"articles/tools/cd.md\"},{\"text\":\"CI (Continuous Implementation)\",\"link\":\"articles/tools/ci.md\"}],\"collapsed\":true},{\"text\":\"iOS\",\"items\":[{\"text\":\"Structs vs Classes in Swift\",\"link\":\"articles/ios/structs-vs-classes.md\"},{\"text\":\"@Bindable vs. @Binding in SwiftUI: What’s the difference?\",\"link\":\"/articles/ios/bindable-vs-binding-swiftui.md\"},{\"text\":\"Understanding Extensions and Protocols in Swift\",\"link\":\"articles/ios/extension-vs-protocol.md\"},{\"text\":\"Core Data\",\"items\":[{\"text\":\"Managing Data in iOS: Core Data vs SwiftData\",\"link\":\"articles/ios/core-data/coredata-vs-swiftdata.md\"},{\"text\":\"Managing Data with Core Data: Fundamentals\",\"link\":\"articles/ios/core-data/coredata-fundamentals.md\"},{\"text\":\"Managing Data with Core Data: Setting Up\",\"link\":\"articles/ios/core-data/coredata-setting-up.md\"},{\"text\":\"Managing Data with Core Data: CRUD Operations\",\"link\":\"articles/ios/core-data/coredata-crud-operations.md\"}]},{\"text\":\"Understanding Memory Mangement in Swift\",\"link\":\"articles/ios/memory-management.md\"}],\"collapsed\":true},{\"text\":\"Web\",\"items\":[{\"text\":\"Types vs. Interfaces in Typescript\",\"link\":\"articles/web/types-vs-interfaces.md\"}],\"collapsed\":true}],\"footer\":{\"message\":\"<a href='https://github.com/carolaneLFBV' target='_blank'>GitHub</a> <a href='#' target='_blank'>LinkedIn</a>\",\"copyright\":\"Copyright © 2020-present Carolane Lefebvre 💻\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>